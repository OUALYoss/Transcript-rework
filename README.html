<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>readme</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="README_files/libs/clipboard/clipboard.min.js"></script>
<script src="README_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="README_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="README_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="README_files/libs/quarto-html/popper.min.js"></script>
<script src="README_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="README_files/libs/quarto-html/anchor.min.js"></script>
<link href="README_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="README_files/libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="README_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="README_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="README_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="transcript-rework" class="level1">
<h1>Transcript Rework</h1>
<p>Pipeline de correction automatique de transcripts téléphoniques pour Omogen.</p>
<section id="le-problème" class="level2">
<h2 class="anchored" data-anchor-id="le-problème">Le problème</h2>
<p>Les outils de transcription automatique (Whisper, Gladia, AssemblyAI…) génèrent des transcripts avec pas mal d’erreurs : fillers (“euh”, “ben”), répétitions (“chez chez”), termes techniques mal transcrits (“postgre sql” au lieu de “PostgreSQL”), ponctuation absente ou incorrecte. Ces erreurs rendent les transcripts difficiles à lire et à exploiter.</p>
</section>
<section id="la-solution" class="level2">
<h2 class="anchored" data-anchor-id="la-solution">La solution</h2>
<p>Un pipeline en 3 étapes qui nettoie les transcripts automatiquement, avec traçabilité complète et évaluation des corrections.</p>
</section>
<section id="architecture-du-pipeline" class="level2">
<h2 class="anchored" data-anchor-id="architecture-du-pipeline">Architecture du pipeline</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="docs/Mermaid%20Chart%20-%20Create%20complex,%20visualdiagrams%20with%20text.-2025-12-30-221529.png" class="img-fluid figure-img"></p>
<figcaption>Pipeline Schema</figcaption>
</figure>
</div>
<p>Le pipeline suit un flux linéaire :</p>
<p><strong>INPUT</strong> → Les transcripts bruts au format JSON contiennent un identifiant, des métadonnées, un contexte métier (glossaire, participants) et la liste des messages avec leurs timestamps.</p>
<p><strong>PIPELINE</strong> → Trois étapes de correction s’enchaînent. D’abord, le Filler Removal supprime les mots parasites via regex. Ensuite, le Repetition Removal élimine les bégaiements. Enfin, le LLM Correction utilise GPT-4o-mini avec le glossaire du contexte pour corriger orthographe, ponctuation et termes techniques.</p>
<p><strong>TRACE</strong> → Chaque transformation est enregistrée avec l’état avant/après, permettant une traçabilité complète.</p>
<p><strong>EVALUATION</strong> → Trois métriques évaluent la qualité : WER (taux d’erreur), précision du glossaire, et un LLM Judge qui note la fidélité et la qualité.</p>
<p><strong>OUTPUT</strong> → Les transcripts corrigés, les rapports de trace et le résumé d’évaluation sont générés.</p>
</section>
<section id="installation" class="level2">
<h2 class="anchored" data-anchor-id="installation">Installation</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/OUALYoss/Transcript-rework.git</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> Transcript-rework</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Créez un fichier <code>.env</code> avec vos credentials :</p>
<pre><code>OPENAI_API_KEY=sk-votre-clé-ici
MODEL=gpt-4o-mini</code></pre>
</section>
<section id="utilisation" class="level2">
<h2 class="anchored" data-anchor-id="utilisation">Utilisation</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> main.py</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Les transcripts dans <code>data/raw/</code> sont traités. Les résultats vont dans <code>data/processed/</code>, les traces dans <code>data/trace/</code>.</p>
</section>
<section id="structure-du-projet" class="level2">
<h2 class="anchored" data-anchor-id="structure-du-projet">Structure du projet</h2>
<pre><code>transcript-rework/
├── main.py                          # Point d'entrée
├── src/
│   ├── model/
│   │   ├── transcript.py            # Modèles Pydantic
│   │   └── trace.py                 # Traçabilité
│   ├── ingestion/
│   │   └── ingestion.py             # Chargement/sauvegarde JSON
│   ├── pipeline.py                  # Orchestrateur
│   ├── steps/
│   │   ├── filler_removal.py        # Étape 1
│   │   ├── repetition_removal.py    # Étape 2
│   │   └── llm_correction.py        # Étape 3
│   └── evaluation/
│       └── metrique.py              # WER, Glossary, LLM Judge
├── data/
│   ├── raw/                         # Transcripts bruts
│   ├── processed/                   # Transcripts corrigés
│   └── trace/                       # Rapports
└── docs/
    └── pipeline_schema.png          # Schéma architecture</code></pre>
</section>
<section id="les-3-étapes-du-pipeline" class="level2">
<h2 class="anchored" data-anchor-id="les-3-étapes-du-pipeline">Les 3 étapes du pipeline</h2>
<p><strong>Étape 1 - Filler Removal (regex)</strong> : Supprime les mots parasites du langage oral comme “euh”, “ben”, “hein”, “bah”, “donc euh”, “tu sais”, “voilà”, “je veux dire”. Ces fillers n’apportent pas d’information et polluent la lecture.</p>
<p><strong>Étape 2 - Repetition Removal (regex)</strong> : Supprime les bégaiements et répétitions. Les mots simples répétés (“de de” → “de”) et les groupes répétés (“en tant que tant que” → “en tant que”) sont corrigés.</p>
<p><strong>Étape 3 - LLM Correction (OpenAI)</strong> : Utilise GPT-4o-mini pour corriger l’orthographe, la ponctuation et appliquer la bonne casse aux termes techniques. Le glossaire du contexte est passé au LLM pour des corrections précises. Le prompt est strict : pas de reformulation, pas d’invention de contenu.</p>
</section>
<section id="exemple-avantaprès" class="level2">
<h2 class="anchored" data-anchor-id="exemple-avantaprès">Exemple avant/après</h2>
<p><strong>Avant :</strong></p>
<pre><code>Bonjour monsieur donc euh merci d'avoir postulé chez nous
Oui bonjour euh ben j'ai travaillé chez chez Techno Corp
Principalement du python avec postgre sql et redis pour le catching</code></pre>
<p><strong>Après :</strong></p>
<pre><code>Bonjour, Monsieur, merci d'avoir postulé chez nous.
Oui, bonjour, j'ai travaillé chez Techno Corp.
Principalement du Python avec PostgreSQL et Redis pour le caching.</code></pre>
</section>
<section id="traçabilité" class="level2">
<h2 class="anchored" data-anchor-id="traçabilité">Traçabilité</h2>
<p>Chaque transformation est enregistrée dans un rapport JSON détaillé :</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"transcript_id"</span><span class="fu">:</span> <span class="st">"t1_recrutement"</span><span class="fu">,</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"timestamp"</span><span class="fu">:</span> <span class="st">"2024-12-30T10:30:00"</span><span class="fu">,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"total_changes"</span><span class="fu">:</span> <span class="dv">12</span><span class="fu">,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"changes"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"step"</span><span class="fu">:</span> <span class="st">"filler_removal"</span><span class="fu">,</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"message_index"</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"before"</span><span class="fu">:</span> <span class="st">"Bonjour monsieur donc euh merci..."</span><span class="fu">,</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"after"</span><span class="fu">:</span> <span class="st">"Bonjour monsieur merci..."</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"step"</span><span class="fu">:</span> <span class="st">"repetition_removal"</span><span class="fu">,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"message_index"</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"before"</span><span class="fu">:</span> <span class="st">"chez chez Techno Corp"</span><span class="fu">,</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"after"</span><span class="fu">:</span> <span class="st">"chez Techno Corp"</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="métriques-dévaluation" class="level2">
<h2 class="anchored" data-anchor-id="métriques-dévaluation">Métriques d’évaluation</h2>
<p>Le projet inclut trois métriques pour évaluer la qualité des corrections.</p>
<p><strong>WER (Word Error Rate)</strong> mesure la distance entre le texte original et corrigé au niveau des mots. Il utilise la distance de Levenshtein et permet de quantifier l’ampleur des modifications.</p>
<p><strong>Glossary Precision</strong> calcule le pourcentage de termes techniques du glossaire correctement présents dans le texte corrigé. Un score de 100% indique que tous les termes attendus sont bien formatés.</p>
<p><strong>LLM Judge</strong> utilise un LLM pour évaluer la qualité sur trois critères notés sur 10 : fidélité (le sens est-il préservé ?), qualité linguistique (orthographe, ponctuation), et termes techniques (sont-ils corrects ?).</p>
<p>Exemple de résultats :</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"transcript_id"</span><span class="fu">:</span> <span class="st">"t1_recrutement"</span><span class="fu">,</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"wer"</span><span class="fu">:</span> <span class="fl">0.32</span><span class="fu">,</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"glossary_precision"</span><span class="fu">:</span> <span class="fl">1.0</span><span class="fu">,</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"llm_judge"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"fidelity"</span><span class="fu">:</span> <span class="dv">10</span><span class="fu">,</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"quality"</span><span class="fu">:</span> <span class="dv">8</span><span class="fu">,</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"technical"</span><span class="fu">:</span> <span class="dv">9</span><span class="fu">,</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"average"</span><span class="fu">:</span> <span class="dv">9</span><span class="fu">,</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"comment"</span><span class="fu">:</span> <span class="st">"Correction précise, sens préservé."</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="format-des-transcripts" class="level2">
<h2 class="anchored" data-anchor-id="format-des-transcripts">Format des transcripts</h2>
<p>Le format d’entrée attendu :</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"transcript_id"</span><span class="fu">:</span> <span class="st">"t1_recrutement"</span><span class="fu">,</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"metadata"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"duration"</span><span class="fu">:</span> <span class="fl">78.4</span><span class="fu">,</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"date"</span><span class="fu">:</span> <span class="st">"2024-12-18T10:15:00Z"</span><span class="fu">,</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"source"</span><span class="fu">:</span> <span class="st">"whisper-large-v3"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"context"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"domain"</span><span class="fu">:</span> <span class="st">"recrutement_tech"</span><span class="fu">,</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"participants"</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">"speaker_0"</span><span class="fu">:</span> <span class="st">"Recruteur"</span><span class="fu">,</span> <span class="dt">"speaker_1"</span><span class="fu">:</span> <span class="st">"Candidat"</span> <span class="fu">},</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"glossary"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"Django"</span><span class="ot">,</span> <span class="st">"PostgreSQL"</span><span class="ot">,</span> <span class="st">"Redis"</span><span class="ot">]</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"messages"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"speaker"</span><span class="fu">:</span> <span class="st">"speaker_0"</span><span class="fu">,</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"content"</span><span class="fu">:</span> <span class="st">"Bonjour donc euh merci d'avoir postulé"</span><span class="fu">,</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"start_time"</span><span class="fu">:</span> <span class="fl">0.0</span><span class="fu">,</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"end_time"</span><span class="fu">:</span> <span class="fl">5.0</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Le champ <code>context.glossary</code> est essentiel : il indique au LLM quels termes techniques doivent être correctement formatés.</p>
</section>
<section id="challenges-en-production" class="level2">
<h2 class="anchored" data-anchor-id="challenges-en-production">Challenges en production</h2>
<p><strong>Coût API</strong> : Chaque message génère un appel OpenAI. Pour optimiser, un mode batch pourrait regrouper plusieurs messages par requête.</p>
<p><strong>Latence</strong> : Environ 500ms par message. Une parallélisation des appels permettrait de traiter les messages simultanément.</p>
<p><strong>Hallucinations LLM</strong> : Malgré un prompt strict, le risque que le LLM invente du contenu existe. La traçabilité permet de détecter ces cas.</p>
<p><strong>Contexte limité</strong> : Le LLM voit un message à la fois, pas la conversation entière. Pour des corrections plus cohérentes, passer plusieurs messages ensemble serait bénéfique.</p>
<p><strong>Langues</strong> : Actuellement optimisé pour le français. Un support multi-langues nécessiterait des adaptations du prompt et des regex.</p>
</section>
<section id="cas-limites" class="level2">
<h2 class="anchored" data-anchor-id="cas-limites">Cas limites</h2>
<p>Les messages très courts (“Oui”, “D’accord”) offrent peu de corrections possibles. Le jargon absent du glossaire risque d’être mal corrigé. Les accents régionaux peuvent produire des transcriptions source de mauvaise qualité que le pipeline ne peut pas rattraper. Les chevauchements de parole (diarisation incorrecte) ne sont pas corrigés par ce pipeline.</p>
</section>
<section id="évolutions-possibles" class="level2">
<h2 class="anchored" data-anchor-id="évolutions-possibles">Évolutions possibles</h2>
<p><strong>Correction de diarisation via LLM</strong> : Analyser le contexte pour réassigner les speakers mal identifiés.</p>
<p><strong>Détection d’omissions</strong> : Identifier les phrases incomplètes ou les coupures anormales.</p>
<p><strong>Mode batch API</strong> : Regrouper les messages pour réduire le nombre d’appels et les coûts.</p>
<p><strong>ReAct Agent (v2)</strong> : Une approche ReAct permettrait un pipeline plus intelligent avec détection dynamique des erreurs, correction itérative (corrige → vérifie → re-corrige), et réassignation des speakers basée sur le contexte. Trade-offs : plus précis sur cas complexes, mais coût API x3-5 et latence plus élevée.</p>
<p><strong>Interface web</strong> : Visualiser les corrections avec diff coloré avant/après.</p>
<p><strong>Pipeline audio complet</strong> : Intégrer Whisper pour un flux audio → texte clean de bout en bout.</p>
</section>
<section id="stack-technique" class="level2">
<h2 class="anchored" data-anchor-id="stack-technique">Stack technique</h2>
<p>Python 3.12, Pydantic pour la validation, OpenAI API (gpt-4o-mini), python-dotenv pour la configuration, regex pour les étapes heuristiques.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>